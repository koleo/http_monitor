INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/sql
                    ${CMAKE_BINARY_DIR}/pcre
                    ${CMAKE_SOURCE_DIR}/pcre
                    ${SSL_INCLUDE_DIRS})

SET(HTTP_MONITOR_SOURCES mongoose.c http_monitor.cc sender_thread.cc http_thread.cc
    url_base.cc url_http.cc utils.cc sys_tbl.cc)

ADD_DEFINITIONS(${SSL_DEFINES})
#ADD_DEFINITIONS(-DDMONGOOSE_USE_POST_SIZE_LIMIT=65000)
#ADD_DEFINITIONS(-DMONGOOSE_USE_STACK_SIZE=128000)

INCLUDE (CheckIncludeFiles)
CHECK_INCLUDE_FILES (netdb.h HAVE_NETDB_H)
IF(HAVE_NETDB_H)
  ADD_DEFINITIONS(-DHAVE_NETDB_H)
ENDIF(HAVE_NETDB_H)

IF(WIN32)
  MYSQL_ADD_PLUGIN(HTTP_MONITOR ${HTTP_MONITOR_SOURCES}
    LINK_LIBRARIES ${SSL_LIBRARIES}
    STATIC_ONLY DEFAULT)
ELSE(WIN32)
  MYSQL_ADD_PLUGIN(HTTP_MONITOR ${HTTP_MONITOR_SOURCES}
    LINK_LIBRARIES ${SSL_LIBRARIES})
ENDIF(WIN32)
